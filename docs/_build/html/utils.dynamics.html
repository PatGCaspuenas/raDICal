<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>utils.dynamics package &mdash; raDICal 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=af2ce170"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="utils.modelling package" href="utils.modelling.html" />
    <link rel="prev" title="utils.data.pre-processing package" href="utils.data.pre-processing.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            raDICal
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">AEs_wControl_user</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="main.html">main module</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="utils.html">utils package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="utils.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="utils.AEs.html">utils.AEs package</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.POD.html">utils.POD package</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.data.html">utils.data package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">utils.dynamics package</a></li>
<li class="toctree-l4"><a class="reference internal" href="utils.modelling.html">utils.modelling package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#module-utils">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">raDICal</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">AEs_wControl_user</a></li>
          <li class="breadcrumb-item"><a href="utils.html">utils package</a></li>
      <li class="breadcrumb-item active">utils.dynamics package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/utils.dynamics.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="utils-dynamics-package">
<h1>utils.dynamics package<a class="headerlink" href="#utils-dynamics-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-utils.dynamics.classes">
<span id="utils-dynamics-classes-module"></span><h2>utils.dynamics.classes module<a class="headerlink" href="#module-utils.dynamics.classes" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="utils.dynamics.classes.DYN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">utils.dynamics.classes.</span></span><span class="sig-name descname"><span class="pre">DYN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PARAMS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FLAGS</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/classes.html#DYN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.classes.DYN" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Dynamical predictor parent class, containing initialization of parameters, NN structure and common utils</p>
<dl class="py method">
<dt class="sig sig-object py" id="utils.dynamics.classes.DYN.LSTM_layers">
<span class="sig-name descname"><span class="pre">LSTM_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/classes.html#DYN.LSTM_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.classes.DYN.LSTM_layers" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.dynamics.classes.DYN.MLP_cell">
<span class="sig-name descname"><span class="pre">MLP_cell</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/classes.html#DYN.MLP_cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.classes.DYN.MLP_cell" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.dynamics.classes.DYN.MLP_layers">
<span class="sig-name descname"><span class="pre">MLP_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/classes.html#DYN.MLP_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.classes.DYN.MLP_layers" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="utils.dynamics.classes.LSTM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">utils.dynamics.classes.</span></span><span class="sig-name descname"><span class="pre">LSTM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/classes.html#LSTM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.classes.LSTM" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#utils.dynamics.classes.DYN" title="utils.dynamics.classes.DYN"><code class="xref py py-class docutils literal notranslate"><span class="pre">DYN</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></p>
<p>LSTM method</p>
<dl class="py method">
<dt class="sig sig-object py" id="utils.dynamics.classes.LSTM.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/classes.html#LSTM.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.classes.LSTM.call" title="Permalink to this definition"></a></dt>
<dd><p>Calls the model on new inputs and returns the outputs as tensors.</p>
<p>In this case <cite>call()</cite> just reapplies
all ops in the graph to the new inputs
(e.g. build a new computational graph from the provided inputs).</p>
<p>Note: This method should not be called directly. It is only meant to be
overridden when subclassing <cite>tf.keras.Model</cite>.
To call a model on an input, always use the <cite>__call__()</cite> method,
i.e. <cite>model(inputs)</cite>, which relies on the underlying <cite>call()</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – Input tensor, or dict/list/tuple of input tensors.</p></li>
<li><p><strong>training</strong> – Boolean or boolean scalar tensor, indicating whether to
run the <cite>Network</cite> in training mode or inference mode.</p></li>
<li><p><strong>mask</strong> – A mask or list of masks. A mask can be either a boolean tensor
or None (no mask). For more details, check the guide
[here](<a class="reference external" href="https://www.tensorflow.org/guide/keras/masking_and_padding">https://www.tensorflow.org/guide/keras/masking_and_padding</a>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor if there is a single output, or
a list of tensors if there are more than one outputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.dynamics.classes.LSTM.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_prop</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/classes.html#LSTM.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.classes.LSTM.predict" title="Permalink to this definition"></a></dt>
<dd><p>Generates output predictions for the input samples.</p>
<p>Computation is done in batches. This method is designed for batch
processing of large numbers of inputs. It is not intended for use inside
of loops that iterate over your data and process small numbers of inputs
at a time.</p>
<p>For small numbers of inputs that fit in one batch,
directly use <cite>__call__()</cite> for faster execution, e.g.,
<cite>model(x)</cite>, or <cite>model(x, training=False)</cite> if you have layers such as
<cite>tf.keras.layers.BatchNormalization</cite> that behave differently during
inference. You may pair the individual model call with a <cite>tf.function</cite>
for additional performance inside your inner loop.
If you need access to numpy array values instead of tensors after your
model call, you can use <cite>tensor.numpy()</cite> to get the numpy array value of
an eager tensor.</p>
<p>Also, note the fact that test loss is not affected by
regularization layers like noise and dropout.</p>
<p>Note: See [this FAQ entry](
<a class="reference external" href="https://keras.io/getting_started/faq/#whats-the-difference-between-model-methods-predict-and-call">https://keras.io/getting_started/faq/#whats-the-difference-between-model-methods-predict-and-call</a>)
for more details about the difference between <cite>Model</cite> methods
<cite>predict()</cite> and <cite>__call__()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – <p>Input samples. It could be:
- A Numpy array (or array-like), or a list of arrays</p>
<blockquote>
<div><p>(in case the model has multiple inputs).</p>
</div></blockquote>
<ul>
<li><p>A TensorFlow tensor, or a list of tensors
(in case the model has multiple inputs).</p></li>
<li><p>A <cite>tf.data</cite> dataset.</p></li>
<li><p>A generator or <cite>keras.utils.Sequence</cite> instance.</p></li>
</ul>
<p>A more detailed description of unpacking behavior for iterator
types (Dataset, generator, Sequence) is given in the <cite>Unpacking
behavior for iterator-like inputs</cite> section of <cite>Model.fit</cite>.</p>
</p></li>
<li><p><strong>batch_size</strong> – Integer or <cite>None</cite>.
Number of samples per batch.
If unspecified, <cite>batch_size</cite> will default to 32.
Do not specify the <cite>batch_size</cite> if your data is in the
form of dataset, generators, or <cite>keras.utils.Sequence</cite> instances
(since they generate batches).</p></li>
<li><p><strong>verbose</strong> – <cite>“auto”</cite>, 0, 1, or 2. Verbosity mode.
0 = silent, 1 = progress bar, 2 = single line.
<cite>“auto”</cite> becomes 1 for most cases, and to 2 when used with
<cite>ParameterServerStrategy</cite>. Note that the progress bar is not
particularly useful when logged to a file, so <cite>verbose=2</cite> is
recommended when not running interactively (e.g. in a production
environment). Defaults to ‘auto’.</p></li>
<li><p><strong>steps</strong> – Total number of steps (batches of samples)
before declaring the prediction round finished.
Ignored with the default value of <cite>None</cite>. If x is a <cite>tf.data</cite>
dataset and <cite>steps</cite> is None, <cite>predict()</cite> will
run until the input dataset is exhausted.</p></li>
<li><p><strong>callbacks</strong> – List of <cite>keras.callbacks.Callback</cite> instances.
List of callbacks to apply during prediction.
See [callbacks](
<a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks">https://www.tensorflow.org/api_docs/python/tf/keras/callbacks</a>).</p></li>
<li><p><strong>max_queue_size</strong> – Integer. Used for generator or
<cite>keras.utils.Sequence</cite> input only. Maximum size for the
generator queue. If unspecified, <cite>max_queue_size</cite> will default
to 10.</p></li>
<li><p><strong>workers</strong> – Integer. Used for generator or <cite>keras.utils.Sequence</cite> input
only. Maximum number of processes to spin up when using
process-based threading. If unspecified, <cite>workers</cite> will default
to 1.</p></li>
<li><p><strong>use_multiprocessing</strong> – Boolean. Used for generator or
<cite>keras.utils.Sequence</cite> input only. If <cite>True</cite>, use process-based
threading. If unspecified, <cite>use_multiprocessing</cite> will default to
<cite>False</cite>. Note that because this implementation relies on
multiprocessing, you should not pass non-picklable arguments to
the generator as they can’t be passed easily to children
processes.</p></li>
</ul>
</dd>
</dl>
<p>See the discussion of <cite>Unpacking behavior for iterator-like inputs</cite> for
<cite>Model.fit</cite>. Note that Model.predict uses the same interpretation rules
as <cite>Model.fit</cite> and <cite>Model.evaluate</cite>, so inputs must be unambiguous for
all three methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Numpy array(s) of predictions.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>RuntimeError</strong> – If <cite>model.predict</cite> is wrapped in a <cite>tf.function</cite>.</p></li>
<li><p><strong>ValueError</strong> – In case of mismatch between the provided
    input data and the model’s expectations,
    or in case a stateful model receives a number of samples
    that is not a multiple of the batch size.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="utils.dynamics.classes.NARX">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">utils.dynamics.classes.</span></span><span class="sig-name descname"><span class="pre">NARX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/classes.html#NARX"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.classes.NARX" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#utils.dynamics.classes.DYN" title="utils.dynamics.classes.DYN"><code class="xref py py-class docutils literal notranslate"><span class="pre">DYN</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></p>
<p>NARX method</p>
<dl class="py method">
<dt class="sig sig-object py" id="utils.dynamics.classes.NARX.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/classes.html#NARX.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.classes.NARX.call" title="Permalink to this definition"></a></dt>
<dd><p>Calls the model on new inputs and returns the outputs as tensors.</p>
<p>In this case <cite>call()</cite> just reapplies
all ops in the graph to the new inputs
(e.g. build a new computational graph from the provided inputs).</p>
<p>Note: This method should not be called directly. It is only meant to be
overridden when subclassing <cite>tf.keras.Model</cite>.
To call a model on an input, always use the <cite>__call__()</cite> method,
i.e. <cite>model(inputs)</cite>, which relies on the underlying <cite>call()</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – Input tensor, or dict/list/tuple of input tensors.</p></li>
<li><p><strong>training</strong> – Boolean or boolean scalar tensor, indicating whether to
run the <cite>Network</cite> in training mode or inference mode.</p></li>
<li><p><strong>mask</strong> – A mask or list of masks. A mask can be either a boolean tensor
or None (no mask). For more details, check the guide
[here](<a class="reference external" href="https://www.tensorflow.org/guide/keras/masking_and_padding">https://www.tensorflow.org/guide/keras/masking_and_padding</a>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor if there is a single output, or
a list of tensors if there are more than one outputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.dynamics.classes.NARX.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_prop</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/classes.html#NARX.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.classes.NARX.predict" title="Permalink to this definition"></a></dt>
<dd><p>Generates output predictions for the input samples.</p>
<p>Computation is done in batches. This method is designed for batch
processing of large numbers of inputs. It is not intended for use inside
of loops that iterate over your data and process small numbers of inputs
at a time.</p>
<p>For small numbers of inputs that fit in one batch,
directly use <cite>__call__()</cite> for faster execution, e.g.,
<cite>model(x)</cite>, or <cite>model(x, training=False)</cite> if you have layers such as
<cite>tf.keras.layers.BatchNormalization</cite> that behave differently during
inference. You may pair the individual model call with a <cite>tf.function</cite>
for additional performance inside your inner loop.
If you need access to numpy array values instead of tensors after your
model call, you can use <cite>tensor.numpy()</cite> to get the numpy array value of
an eager tensor.</p>
<p>Also, note the fact that test loss is not affected by
regularization layers like noise and dropout.</p>
<p>Note: See [this FAQ entry](
<a class="reference external" href="https://keras.io/getting_started/faq/#whats-the-difference-between-model-methods-predict-and-call">https://keras.io/getting_started/faq/#whats-the-difference-between-model-methods-predict-and-call</a>)
for more details about the difference between <cite>Model</cite> methods
<cite>predict()</cite> and <cite>__call__()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – <p>Input samples. It could be:
- A Numpy array (or array-like), or a list of arrays</p>
<blockquote>
<div><p>(in case the model has multiple inputs).</p>
</div></blockquote>
<ul>
<li><p>A TensorFlow tensor, or a list of tensors
(in case the model has multiple inputs).</p></li>
<li><p>A <cite>tf.data</cite> dataset.</p></li>
<li><p>A generator or <cite>keras.utils.Sequence</cite> instance.</p></li>
</ul>
<p>A more detailed description of unpacking behavior for iterator
types (Dataset, generator, Sequence) is given in the <cite>Unpacking
behavior for iterator-like inputs</cite> section of <cite>Model.fit</cite>.</p>
</p></li>
<li><p><strong>batch_size</strong> – Integer or <cite>None</cite>.
Number of samples per batch.
If unspecified, <cite>batch_size</cite> will default to 32.
Do not specify the <cite>batch_size</cite> if your data is in the
form of dataset, generators, or <cite>keras.utils.Sequence</cite> instances
(since they generate batches).</p></li>
<li><p><strong>verbose</strong> – <cite>“auto”</cite>, 0, 1, or 2. Verbosity mode.
0 = silent, 1 = progress bar, 2 = single line.
<cite>“auto”</cite> becomes 1 for most cases, and to 2 when used with
<cite>ParameterServerStrategy</cite>. Note that the progress bar is not
particularly useful when logged to a file, so <cite>verbose=2</cite> is
recommended when not running interactively (e.g. in a production
environment). Defaults to ‘auto’.</p></li>
<li><p><strong>steps</strong> – Total number of steps (batches of samples)
before declaring the prediction round finished.
Ignored with the default value of <cite>None</cite>. If x is a <cite>tf.data</cite>
dataset and <cite>steps</cite> is None, <cite>predict()</cite> will
run until the input dataset is exhausted.</p></li>
<li><p><strong>callbacks</strong> – List of <cite>keras.callbacks.Callback</cite> instances.
List of callbacks to apply during prediction.
See [callbacks](
<a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks">https://www.tensorflow.org/api_docs/python/tf/keras/callbacks</a>).</p></li>
<li><p><strong>max_queue_size</strong> – Integer. Used for generator or
<cite>keras.utils.Sequence</cite> input only. Maximum size for the
generator queue. If unspecified, <cite>max_queue_size</cite> will default
to 10.</p></li>
<li><p><strong>workers</strong> – Integer. Used for generator or <cite>keras.utils.Sequence</cite> input
only. Maximum number of processes to spin up when using
process-based threading. If unspecified, <cite>workers</cite> will default
to 1.</p></li>
<li><p><strong>use_multiprocessing</strong> – Boolean. Used for generator or
<cite>keras.utils.Sequence</cite> input only. If <cite>True</cite>, use process-based
threading. If unspecified, <cite>use_multiprocessing</cite> will default to
<cite>False</cite>. Note that because this implementation relies on
multiprocessing, you should not pass non-picklable arguments to
the generator as they can’t be passed easily to children
processes.</p></li>
</ul>
</dd>
</dl>
<p>See the discussion of <cite>Unpacking behavior for iterator-like inputs</cite> for
<cite>Model.fit</cite>. Note that Model.predict uses the same interpretation rules
as <cite>Model.fit</cite> and <cite>Model.evaluate</cite>, so inputs must be unambiguous for
all three methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Numpy array(s) of predictions.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>RuntimeError</strong> – If <cite>model.predict</cite> is wrapped in a <cite>tf.function</cite>.</p></li>
<li><p><strong>ValueError</strong> – In case of mismatch between the provided
    input data and the model’s expectations,
    or in case a stateful model receives a number of samples
    that is not a multiple of the batch size.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-utils.dynamics.config">
<span id="utils-dynamics-config-module"></span><h2>utils.dynamics.config module<a class="headerlink" href="#module-utils.dynamics.config" title="Permalink to this heading"></a></h2>
</section>
<section id="module-utils.dynamics.optimizers">
<span id="utils-dynamics-optimizers-module"></span><h2>utils.dynamics.optimizers module<a class="headerlink" href="#module-utils.dynamics.optimizers" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="utils.dynamics.optimizers.DampingAlgorithm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">utils.dynamics.optimizers.</span></span><span class="sig-name descname"><span class="pre">DampingAlgorithm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starting_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive_scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fletcher</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/optimizers.html#DampingAlgorithm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.optimizers.DampingAlgorithm" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Default Levenberg–Marquardt damping algorithm.</p>
<p>This is used inside the LM_Trainer as a generic class. Many damping algorithms
can be implemented using the same interface.</p>
<dl class="py method">
<dt class="sig sig-object py" id="utils.dynamics.optimizers.DampingAlgorithm.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">damping_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">JJ</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/optimizers.html#DampingAlgorithm.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.optimizers.DampingAlgorithm.apply" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.dynamics.optimizers.DampingAlgorithm.decrease">
<span class="sig-name descname"><span class="pre">decrease</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">damping_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/optimizers.html#DampingAlgorithm.decrease"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.optimizers.DampingAlgorithm.decrease" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.dynamics.optimizers.DampingAlgorithm.increase">
<span class="sig-name descname"><span class="pre">increase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">damping_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/optimizers.html#DampingAlgorithm.increase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.optimizers.DampingAlgorithm.increase" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.dynamics.optimizers.DampingAlgorithm.init_step">
<span class="sig-name descname"><span class="pre">init_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">damping_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/optimizers.html#DampingAlgorithm.init_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.optimizers.DampingAlgorithm.init_step" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.dynamics.optimizers.DampingAlgorithm.stop_training">
<span class="sig-name descname"><span class="pre">stop_training</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">damping_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/optimizers.html#DampingAlgorithm.stop_training"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.optimizers.DampingAlgorithm.stop_training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="utils.dynamics.optimizers.LM_Trainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">utils.dynamics.optimizers.</span></span><span class="sig-name descname"><span class="pre">LM_Trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/optimizers.html#LM_Trainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.optimizers.LM_Trainer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></p>
<p>Levenberg–Marquardt training algorithm.</p>
<dl class="py method">
<dt class="sig sig-object py" id="utils.dynamics.optimizers.LM_Trainer.backup_variables">
<span class="sig-name descname"><span class="pre">backup_variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/optimizers.html#LM_Trainer.backup_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.optimizers.LM_Trainer.backup_variables" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.dynamics.optimizers.LM_Trainer.reset_damping_factor">
<span class="sig-name descname"><span class="pre">reset_damping_factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/optimizers.html#LM_Trainer.reset_damping_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.optimizers.LM_Trainer.reset_damping_factor" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.dynamics.optimizers.LM_Trainer.restore_variables">
<span class="sig-name descname"><span class="pre">restore_variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/optimizers.html#LM_Trainer.restore_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.optimizers.LM_Trainer.restore_variables" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="utils.dynamics.optimizers.LM_Trainer.train_step">
<span class="sig-name descname"><span class="pre">train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/optimizers.html#LM_Trainer.train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.optimizers.LM_Trainer.train_step" title="Permalink to this definition"></a></dt>
<dd><p>The logic for one training step.</p>
<p>This method can be overridden to support custom training logic.
For concrete examples of how to override this method see
[Customizing what happens in fit](
<a class="reference external" href="https://www.tensorflow.org/guide/keras/customizing_what_happens_in_fit">https://www.tensorflow.org/guide/keras/customizing_what_happens_in_fit</a>).
This method is called by <cite>Model.make_train_function</cite>.</p>
<p>This method should contain the mathematical logic for one step of
training.  This typically includes the forward pass, loss calculation,
backpropagation, and metric updates.</p>
<p>Configuration details for <em>how</em> this logic is run (e.g. <cite>tf.function</cite>
and <cite>tf.distribute.Strategy</cite> settings), should be left to
<cite>Model.make_train_function</cite>, which can also be overridden.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – A nested structure of <a href="#id1"><span class="problematic" id="id2">`</span></a>Tensor`s.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <cite>dict</cite> containing values that will be passed to
<cite>tf.keras.callbacks.CallbackList.on_train_batch_end</cite>. Typically, the
values of the <cite>Model</cite>’s metrics are returned. Example:
<cite>{‘loss’: 0.2, ‘accuracy’: 0.7}</cite>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-utils.dynamics.outputs">
<span id="utils-dynamics-outputs-module"></span><h2>utils.dynamics.outputs module<a class="headerlink" href="#module-utils.dynamics.outputs" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="utils.dynamics.outputs.get_predicted_flow">
<span class="sig-prename descclassname"><span class="pre">utils.dynamics.outputs.</span></span><span class="sig-name descname"><span class="pre">get_predicted_flow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PARAMS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FLAGS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PATHS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zy_dyn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/outputs.html#get_predicted_flow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.outputs.get_predicted_flow" title="Permalink to this definition"></a></dt>
<dd><p>Decodes predicted latent space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>PARAMS</strong> – dictionary of parameters</p></li>
<li><p><strong>FLAGS</strong> – dictionary of flags</p></li>
<li><p><strong>PATHS</strong> – dictionary of paths</p></li>
<li><p><strong>zy</strong> – ground truth of PW latent space (N_w, w_prop, N_z)</p></li>
<li><p><strong>zy_dyn</strong> – predicted latent space (N_w, w_prop, N_z)</p></li>
<li><p><strong>by</strong> – control vector in PW</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>decoded flow with ground truth and predicted latent space (N_w, N_v, w_prop)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="utils.dynamics.outputs.get_predicted_z">
<span class="sig-prename descclassname"><span class="pre">utils.dynamics.outputs.</span></span><span class="sig-name descname"><span class="pre">get_predicted_z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PARAMS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FLAGS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DYN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/outputs.html#get_predicted_z"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.outputs.get_predicted_z" title="Permalink to this definition"></a></dt>
<dd><p>Predicts latent space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>PARAMS</strong> – dictionary of parameters</p></li>
<li><p><strong>FLAGS</strong> – dictionary of flags</p></li>
<li><p><strong>DYN</strong> – dynamical predictor model</p></li>
<li><p><strong>z</strong> – latent space in raw format (N_t, N_z)</p></li>
<li><p><strong>t</strong> – time vector (N_t,1)</p></li>
<li><p><strong>u</strong> – control vector, if needed (N_t, N_c)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>TDL and PW latent and control space</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-utils.dynamics.train">
<span id="utils-dynamics-train-module"></span><h2>utils.dynamics.train module<a class="headerlink" href="#module-utils.dynamics.train" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="utils.dynamics.train.train_dyn">
<span class="sig-prename descclassname"><span class="pre">utils.dynamics.train.</span></span><span class="sig-name descname"><span class="pre">train_dyn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PARAMS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FLAGS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logging</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/utils/dynamics/train.html#train_dyn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#utils.dynamics.train.train_dyn" title="Permalink to this definition"></a></dt>
<dd><p>Trains dynamical predictor model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>PARAMS</strong> – dictionary of parameters</p></li>
<li><p><strong>FLAGS</strong> – dictionary of flags</p></li>
<li><p><strong>z</strong> – latent space (N_t, N_z)</p></li>
<li><p><strong>t</strong> – time vector (N_t, 1)</p></li>
<li><p><strong>logging</strong> – logger object</p></li>
<li><p><strong>b</strong> – control vector, if needed (N_t, N_c)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dynamical predictor class model</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-utils.dynamics">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-utils.dynamics" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="utils.data.pre-processing.html" class="btn btn-neutral float-left" title="utils.data.pre-processing package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="utils.modelling.html" class="btn btn-neutral float-right" title="utils.modelling package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Patricía Garcia-Caspueñas.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>